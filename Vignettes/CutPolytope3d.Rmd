---
title: "The 3d cut polytope"
author: "Alexander J. McNeil and Johanna Neslehova"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{The 3d cut polytope}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}---
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
library(extremalcopula)
library(rcdd)
library(rgl)
library(gMOIP)
knitr::knit_hooks$set(webgl = hook_webgl)
```

We will find the cut polytope of possible concordance probabilities in 3 dimensions. First, we find the vertices of the polytope of weights. These take a trivial form: they are the 4 vertices of the 4-dimensional simplex.

```{r, echo=TRUE}
weights <- findpolytope(1, d = 3)
weights
```

Now we determine the correponding vertices of the polytope of concordance probabilities for the 3 pairs of random variables. There are 4 vertices: 3 vertices in which a single pair has concordance probability one and the others have concordance probability zero; 1 vertex in which all pairs have concordance probability 1.

```{r, echo=TRUE}
allkappa <- Amatrix(3) %*% t(weights)
k.vertices <- t(allkappa[-1, ])
k.vertices
```

We can display the polytope.

```{r, echo=TRUE, webgl=TRUE, fig.height = 6, fig.width = 6}
plot3d(k.vertices)
plotHull3D(k.vertices)
```

We repeat the exercise for the polytope that describes the possible Kendall rank correlation matrices. This is the cut polytope.

```{r, echo=TRUE, webgl=TRUE, fig.height = 6, fig.width = 6}
alltau <- 2*allkappa -1
t.vertices <- t(alltau[-1, ])
t.vertices
plot3d(t.vertices)
plotHull3D(t.vertices)
```
