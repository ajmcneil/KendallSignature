---
title: "A correlation matrix that is not a Kendall's tau matrix"
author: "Alexander J. McNeil and Johanna Neslehova"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{A correlation matrix that is not a Kendall's tau matrix}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
library(extremalcopula)
```

Here is a positive-definite correlation matrix.
```{r, echo=TRUE}
rho <- -5/12
P <- matrix(rho, nrow = 3, ncol = 3) + (1-rho)*diag(3)
P
eigen(P)$values
```

If this is a Kendall's tau matrix then the concordance signature is given by.
```{r, echo=TRUE}
kappa <- c(1, (1 + P[lower.tri(P)])/2)
kappa
```

The A matrix in 3 dimensions is easily computed.
```{r, echo=TRUE}
Amatrix(3)
```

The extremal mixture weights must be:
```{r, echo=TRUE}
solve(Amatrix(3), kappa)
```

But unfortunately this yields a negative weight, which is a contradiction.

Let's do the whole thing again but with a different rho value.
```{r, echo=TRUE}
rho <- -1/3
P <- matrix(rho, nrow = 3, ncol = 3) + (1-rho)*diag(3)
P
eigen(P)$values
```

If this is a Kendall's tau matrix then the concordance signature is given by.
```{r, echo=TRUE}
kappa <- c(1, (1 + P[lower.tri(P)])/2)
kappa
```

The A matrix in 3 dimensions is easily computed.
```{r, echo=TRUE}
Amatrix(3)
```

The extremal mixture weights must be:
```{r, echo=TRUE}
solve(Amatrix(3), kappa)
```
This works fine. Note how the solution attaches zero weight to the first extremal copula and equal weight to the others.
